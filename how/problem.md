# 分库分表产生的问题

## 写的问题

### 分布式事务

#### 理论

- CAP定理
```
一致性(Consistency) ： 客户端知道一系列的操作都会同时发生(生效)
可用性(Availability) ： 每个操作都必须以可预期的响应结束
分区容错性(Partition tolerance) ： 即使出现单个组件无法可用,操作依然可以完成
```
- BASE理论
```
核心思想：我们无法做到强一致，但每个应用都可以根据自身的业务特点，采用适当的方式来使系统达到最终一致性
Basically Available（基本可用）
Soft state（软状态）
Eventually consistent（最终一致性）
```

分库分表之后不可避免的就产生了分布式事务。

常用的解决分布式事务的方案
#### 解决方案

- 两阶段提交 2PC
- 补偿事务 TCC
- 本地消息表
- MQ事务消息
- Sagas 事务模型

## 读的问题

### 多个库结果集合并
```
findByIds ids分布在多库多表中 怎么样把结果集合并返回给调用方

一般的分库分表中间件已经解决这个问题。
```
### 跨库join
```
解决办法
service层组装
```
